<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>BLOCK ‚Ä¢ 8√ó8 ‚Äî Minimal Lux</title>

  <style>
    /* =========================
       ROOT & RESET
    ========================== */
    :root {
      --bg: #0b0f16;        /* tamna pozadina */
      --text: #e8ecf1;      /* osnovni tekst */
      --muted: #a6afc3;     /* sporedni tekst */
      --accent: #35d7ff;    /* nagla≈°ena boja (menja je tema iz script.js) */
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
      overflow: hidden; /* igrica NE skroluje */
    }
    button, [role="button"] {
      outline: none;
      border: none;
      cursor: pointer;
    }
    ::selection { background: transparent; }

    /* =========================
       AURORA POZADINA ‚Äî ZVEZDA PODLOGE
       (uvek ispod svega: z-index: 0)
    ========================== */
    #bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      display: block;
      width: 100%;
      height: 100%;
      pointer-events: none; /* da ne blokira klikove */
    }

    /* =========================
       START SCREEN (glavni meni)
       z-index: 2 (iznad pozadine)
    ========================== */
    #startScreen {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }
    #startScreen .ss-inner {
      position: relative;
      z-index: 3;
      text-align: center;
      padding: 20px;
      width: 100%;
      max-width: 720px;
    }
    #startScreen h1 {
      margin: 0 0 8px 0;
      font-size: 28px;
      letter-spacing: 0.5px;
      font-weight: 800;
      text-shadow: 0 6px 24px rgba(0,0,0,.35);
    }
    .cta-row { display: flex; gap: 12px; justify-content: center; margin-top: 10px; }
    .icon-row { display: flex; gap: 10px; justify-content: center; margin-top: 14px; }

    /* Settings dugme gore desno (kao ranije) */
    #settingsBtn {
      position: fixed;
      top: 12px;
      right: 12px;
      z-index: 4;
      background: rgba(0,0,0,.28);
      color: #fff;
      padding: 10px 12px;
      border-radius: 12px;
      font-weight: 700;
    }

    /* Osnovno dugme (crno + blagi sjaj) */
    .btn {
      background: rgba(0,0,0,.30);
      color: #fff;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 700;
      transition: transform .08s ease, opacity .12s ease;
    }
    .btn:active { transform: translateY(1px); }

    /* =========================
       APP (igra)
       z-index: 3 (iznad pozadine)
    ========================== */
    .wrap {
      position: relative;
      z-index: 3;
      display: none;           /* sakriveno dok ne udje≈° u igru */
      flex-direction: column;
      height: 100%;
      max-width: 720px;
      margin: 0 auto;
    }

    header {
      padding: 10px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }
    .brand {
      font-weight: 800;
      letter-spacing: .3px;
      opacity: .9;
      text-shadow: 0 6px 24px rgba(0,0,0,.35);
    }
    .hud { display: flex; gap: 10px; }
    .pill {
      background: rgba(0,0,0,.28);
      padding: 6px 10px;
      border-radius: 12px;
      font-weight: 700;
    }
    .toolbar { display: flex; gap: 8px; }

    /* =========================
       BOARD AREA (kanvasi)
       #game i #fx su iznad pozadine (z-index: 4)
    ========================== */
    .board-area {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 16px;
      position: relative;
      z-index: 3;
    }
    #game, #fx {
      position: relative;
      z-index: 4;      /* KLJUƒåNO: blokovi i efekti iznad pozadine */
      touch-action: none;
      display: block;
    }

    /* =========================
       TRAY ‚Äî PRILEPLJEN UZ GRID, BEZ OKVIRA
       z-index: 4 (iznad pozadine)
    ========================== */
    .tray {
      position: relative;
      z-index: 4;
      display: grid;
      grid-template-columns: repeat(3, minmax(80px, 1fr));
      gap: 10px;
      padding: 8px 16px 16px;
      margin-top: 6px;         /* BLIZU grida ‚Äì odmah ispod */
      align-items: center;
      justify-items: center;
      user-select: none;
    }
    .slot {
      background: transparent; /* bez okvira/pozadine */
      border: none;
      border-radius: 16px;
      min-height: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4px;
    }
    .slot.used { opacity: .30; }
    .slot.good, .slot.bad { outline: none; }

    .footer {
      text-align: center;
      opacity: .6;
      font-size: 12px;
      padding-bottom: 10px;
    }

    /* =========================
       MODALI (Settings, Achievements, Collection, Game Over)
       z-index: 5 (iznad svega interfejsa)
    ========================== */
    .overlay,
    #settingsModal,
    #achievementsModal,
    #collectionModal,
    #onboarding,
    #gameOver {
      position: fixed;
      inset: 0;
      display: none;
      z-index: 5;
      align-items: center;
      justify-content: center;
    }
    .overlay .backdrop,
    #settingsModal .backdrop,
    #achievementsModal .backdrop,
    #collectionModal .backdrop,
    #gameOver .backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,.50);
    }
    .overlay .panel,
    #settingsModal .panel,
    #achievementsModal .panel,
    #collectionModal .panel,
    #gameOver .panel {
      position: relative;
      z-index: 6;
      background: rgba(10,14,22,.92);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 16px;
      padding: 16px;
      max-width: 720px;
      width: 90%;
    }

    /* ========== Achievements minimal stil (id-ovi su bitni za script.js) ========== */
    #achList { display: grid; gap: 8px; }
    .ach-card {
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 12px;
      padding: 10px;
    }
    .ach-card.done { opacity: .65; }
    .ach-card .meta { display:flex; align-items:center; gap:8px; opacity:.9; }
    .ach-card .badge { background: rgba(255,255,255,.08); border-radius: 10px; padding: 3px 6px; font-size: 12px; }
    .ach-card .small { font-size: 12px; opacity: .8; }
    .ach-card .progress { height: 6px; background: #111; border-radius: 6px; overflow: hidden; margin-top: 6px; }
    .ach-card .progress i { display:block; height:100%; width:0%; background: var(--accent); }

    /* ========== Collection minimal (Teme / Skinovi) ========== */
    #panelThemes[aria-hidden="true"], #panelSkins[aria-hidden="true"] { display: none; }
    .col-card {
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 12px;
      padding: 10px;
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 8px;
    }
    .col-card.locked { opacity: .5; }
    .col-card .badge { background: rgba(255,255,255,.08); border-radius: 10px; padding: 3px 6px; font-size: 12px; }
    .col-card .apply { background: rgba(0,0,0,.4); color: #fff; padding: 6px 10px; border-radius: 10px; font-weight: 700; }
    .col-card .activeTag { background: rgba(53,215,255,.18); color: #d6f6ff; padding: 4px 6px; border-radius: 8px; font-size: 12px; }

  </style>
</head>
<body>

  <!-- AURORA POZADINA -->
  <canvas id="bg"></canvas>

  <!-- START SCREEN -->
  <div id="startScreen">
    <button id="settingsBtn" title="Pode≈°avanja">‚öôÔ∏è</button>
    <div class="ss-inner">
      <h1>BLOCK ‚Ä¢ 8√ó8</h1>

      <div class="cta-row">
        <button id="startClassic" class="btn" title="Igraj klasiƒçno">‚ñ∂ Igraj</button>
        <button id="startObstacles" class="btn" title="Mod sa preprekama">üß© Prepreke</button>
      </div>

      <div class="icon-row">
        <button id="achBtn" class="btn" title="Dostignuƒáa">üèÜ</button>
        <button id="collectionBtn" class="btn" title="Kolekcija">üé®</button>
      </div>
    </div>
  </div>

  <!-- APP / IGRA -->
  <div class="wrap" id="app">
    <header>
      <div class="brand">BLOCK ‚Ä¢ 8√ó8</div>
      <div class="hud">
        <div class="pill">Score: <span id="score">0</span></div>
        <div class="pill">Best: <span id="best">0</span></div>
        <div class="pill" id="levelPill" style="display:none">Lvl: <span id="lvl">1</span></div>
      </div>
      <div class="toolbar">
        <button id="backBtn" class="btn" title="Meni">üè†</button>
        <button id="reset" class="btn" title="Reset">‚Ü∫</button>
      </div>
    </header>

    <div class="board-area">
      <canvas id="game" width="360" height="360" aria-label="tabla"></canvas>
      <canvas id="fx" width="360" height="360"></canvas>
    </div>

    <!-- TRAY: odmah uz grid, bez okvira -->
    <div class="tray" id="tray"></div>

    <div class="footer">Aurora ‚Ä¢ Kolekcija ‚Ä¢ Dostignuƒáa</div>
  </div>

  <!-- SETTINGS MODAL -->
  <div id="settingsModal" class="overlay">
    <div class="backdrop"></div>
    <div class="panel">
      <h3>Pode≈°avanja</h3>
      <div class="row"><span>Tema</span> <button id="setTheme" class="btn">Prebaci temu</button></div>
      <div class="row"><span>Zvuk</span> <button id="setSound" class="btn">üîà On</button></div>
      <div class="row"><span>Resetuj Best</span> <button id="resetBest" class="btn">Obri≈°i</button></div>
      <div style="text-align:right; margin-top:8px"><button id="closeSettings" class="btn">Zatvori</button></div>
    </div>
  </div>

  <!-- ACHIEVEMENTS MODAL -->
  <div id="achievementsModal" class="overlay">
    <div class="backdrop"></div>
    <div class="panel">
      <h3>Dostignuƒáa</h3>
      <div style="display:flex; gap:8px; margin-bottom:8px">
        <button id="achPrev" class="btn">‚üµ</button>
        <div id="achPageLbl" class="pill">1</div>
        <button id="achNext" class="btn">‚ü∂</button>
      </div>
      <div id="achList"></div>
      <hr/>
      <div>
        <div id="msTitle" style="font-weight:800; margin-bottom:6px"></div>
        <div id="msDesc" class="pill" style="display:inline-block; margin-bottom:6px"></div>
        <div style="height:8px; background:#111; border-radius:8px; overflow:hidden; margin:6px 0">
          <i id="msBar" style="display:block; height:100%; width:0%; background:var(--accent)"></i>
        </div>
        <div id="msCounters" style="opacity:.8"></div>
        <div id="msBlockProg" style="opacity:.8"></div>
        <div style="display:flex; gap:8px; margin-top:8px">
          <button id="btnWatchAd" class="btn">‚ñ∂ Reklama</button>
          <button id="btnClaim" class="btn" aria-disabled="true">Preuzmi</button>
        </div>
      </div>
      <div style="text-align:right; margin-top:8px"><button id="closeAch" class="btn">Zatvori</button></div>
    </div>
  </div>

  <!-- COLLECTION MODAL -->
  <div id="collectionModal" class="overlay">
    <div class="backdrop"></div>
    <div class="panel">
      <h3>Kolekcija</h3>
      <div style="display:flex; gap:8px; margin-bottom:8px">
        <button id="tabThemes" class="btn" aria-selected="true">Teme</button>
        <button id="tabSkins" class="btn" aria-selected="false">Skinovi</button>
      </div>
      <div id="panelThemes">
        <div id="themesGrid" style="display:grid; grid-template-columns:repeat(2,1fr); gap:10px"></div>
      </div>
      <div id="panelSkins" aria-hidden="true" style="display:none">
        <div id="skinsGrid" style="display:grid; grid-template-columns:repeat(2,1fr); gap:10px"></div>
      </div>
      <div style="text-align:right; margin-top:8px"><button id="closeCollection" class="btn">Zatvori</button></div>
    </div>
  </div>

  <!-- GAME OVER -->
  <div id="gameOver" class="overlay">
    <div class="backdrop"></div>
    <div class="panel">
      <h2>Kraj igre</h2>
      <div id="goStats" style="margin:6px 0 12px 0">Score: 0 ‚Ä¢ Best: 0</div>
      <div style="display:flex; gap:8px; justify-content:center">
        <button id="playAgain" class="btn">Igraj ponovo</button>
        <button id="goMenu" class="btn">Meni</button>
      </div>
    </div>
  </div>

  <!-- POVEZIVANJE LOGIKE -->
  <script src="script.js"></script>
</body>
</html>
