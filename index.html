<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Block Puzzle 8√ó8 ‚Äî Minimal Lux</title>
  <style>
    :root { --bg:#0b0f16; --text:#e8ecf1; --muted:#a6afc3; --accent:#35d7ff; }

    /* RESET */
    * { box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height:100%; margin:0; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif; overflow:hidden; }

    /* LAYERING (bitno za #bg iza svega) */
    #bg { position:fixed; inset:0; z-index:0; pointer-events:none; }

    /* START SCREEN */
    #startScreen { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:2; }
    #startScreen .ss-inner { position:relative; z-index:3; text-align:center; padding:20px; max-width:720px; width:100%; }
    #settingsBtn { position:fixed; top:12px; right:12px; z-index:4; border:none; background:rgba(0,0,0,.28); color:#fff; padding:10px 12px; border-radius:12px; font-weight:700; }

    /* APP (igra) */
    .wrap { position:relative; z-index:3; display:none; flex-direction:column; height:100%; max-width:720px; margin:0 auto; }
    header { padding:10px 12px; display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .brand { font-weight:800; letter-spacing:.3px; opacity:.9 }
    .hud { display:flex; gap:10px; }
    .pill { background:rgba(0,0,0,.28); padding:6px 10px; border-radius:12px; font-weight:700; }

    .toolbar { display:flex; gap:8px; }
    .btn { background:rgba(0,0,0,.30); border:none; color:#fff; padding:8px 12px; border-radius:12px; font-weight:700; cursor:pointer; outline:none; }
    .btn:focus { outline:none; }
    .btn:active { transform:translateY(1px); }

    /* BOARD AREA ‚Äî dr≈æimo canvase iznad #bg */
    .board-area { flex:1; display:flex; align-items:center; justify-content:center; padding:0 16px; position:relative; z-index:3; }
    #game, #fx { position:relative; z-index:4; touch-action:none; display:block; }

    /* TRAY ‚Äî ZALEPLJEN UZ GRID, BEZ OKVIRA */
    .tray { position:relative; z-index:4; display:grid; grid-template-columns: repeat(3, minmax(80px, 1fr)); gap:10px;
            padding:8px 16px 16px; margin-top:6px; /* ovo ga privlaƒçi odmah ispod grida */
            align-items:center; justify-items:center; }
    .slot { border:none; background:transparent; border-radius:16px; min-height:auto; display:flex; align-items:center; justify-content:center; padding:4px; }
    .slot.used { opacity:.30 }
    .slot.good { outline:none; }
    .slot.bad  { outline:none; }

    .footer { text-align:center; opacity:.6; font-size:12px; padding-bottom:10px }

    /* MODALI (ostavljeno kako je ‚Äì bitan je z-index) */
    #settingsModal, #achievementsModal, #collectionModal, #onboarding, #gameOver {
      position:fixed; inset:0; display:none; z-index:5; align-items:center; justify-content:center;
    }
    .overlay .backdrop, #settingsModal .backdrop, #achievementsModal .backdrop, #collectionModal .backdrop, #gameOver .backdrop {
      position:absolute; inset:0; background:rgba(0,0,0,.50);
    }
    .overlay .panel, #settingsModal .panel, #achievementsModal .panel, #collectionModal .panel, #gameOver .panel {
      position:relative; z-index:6; background:rgba(10,14,22,.92); border:1px solid rgba(255,255,255,.06);
      border-radius:16px; padding:16px; max-width:720px; width:90%;
    }

    /* Onemoguƒáavanje plavog fokusa/selektovanja */
    button, [role="button"] { outline:none; }
    ::selection { background: transparent; }
  </style>
</head>
<body>
  <!-- Aurora pozadina (uvek iza svega) -->
  <canvas id="bg"></canvas>

  <!-- START SCREEN -->
  <div id="startScreen">
    <button id="settingsBtn">‚öôÔ∏è</button>
    <div class="ss-inner">
      <h1>BLOCK ‚Ä¢ 8√ó8</h1>
      <div class="cta" style="display:flex; gap:12px; justify-content:center; margin-top:10px">
        <button id="startClassic" class="btn">‚ñ∂ Igraj</button>
        <button id="startObstacles" class="btn">üß© Prepreke</button>
      </div>
      <div style="margin-top:14px; display:flex; gap:10px; justify-content:center">
        <button id="achBtn" class="btn" title="Dostignuƒáa">üèÜ</button>
        <button id="collectionBtn" class="btn" title="Kolekcija">üé®</button>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div class="wrap" id="app">
    <header>
      <div class="brand">BLOCK ‚Ä¢ 8√ó8</div>
      <div class="hud">
        <div class="pill">Score: <span id="score">0</span></div>
        <div class="pill">Best: <span id="best">0</span></div>
        <div class="pill" id="levelPill" style="display:none">Lvl: <span id="lvl">1</span></div>
      </div>
      <div class="toolbar">
        <button id="backBtn" class="btn" title="Meni">üè†</button>
        <button id="reset" class="btn" title="Reset">‚Ü∫</button>
      </div>
    </header>

    <div class="board-area">
      <canvas id="game" width="360" height="360" aria-label="tabla"></canvas>
      <canvas id="fx" width="360" height="360"></canvas>
    </div>

    <!-- TRAY odmah ispod grida, bez okvira -->
    <div class="tray" id="tray"></div>

    <div class="footer">Aurora ‚Ä¢ Kolekcija ‚Ä¢ Dostignuƒáa</div>
  </div>

  <!-- Settings / Achievements / Collection / GameOver markup ostaje isti kao kod tebe (id-ovi ne menjani) -->
  <div id="settingsModal" class="overlay"><div class="backdrop"></div><div class="panel">
    <h3>Pode≈°avanja</h3>
    <div class="row"><span>Tema</span><button id="setTheme" class="btn">Prebaci temu</button></div>
    <div class="row"><span>Zvuk</span><button id="setSound" class="btn">üîà On</button></div>
    <div class="row"><span>Resetuj Best</span><button id="resetBest" class="btn">Obri≈°i</button></div>
    <div style="text-align:right; margin-top:8px"><button id="closeSettings" class="btn">Zatvori</button></div>
  </div></div>

  <div id="achievementsModal" class="overlay"><div class="backdrop"></div><div class="panel">
    <h3>Dostignuƒáa</h3>
    <div style="display:flex; gap:8px; margin-bottom:8px">
      <button id="achPrev" class="btn">‚üµ</button>
      <div id="achPageLbl" class="pill">1</div>
      <button id="achNext" class="btn">‚ü∂</button>
    </div>
    <div id="achList"></div>
    <hr/>
    <div>
      <div id="msTitle" style="font-weight:800; margin-bottom:6px"></div>
      <div id="msDesc" class="pill" style="display:inline-block; margin-bottom:6px"></div>
      <div style="height:8px; background:#111; border-radius:8px; overflow:hidden; margin:6px 0">
        <i id="msBar" style="display:block; height:100%; width:0%; background:var(--accent)"></i>
      </div>
      <div id="msCounters" style="opacity:.8"></div>
      <div id="msBlockProg" style="opacity:.8"></div>
      <div style="display:flex; gap:8px; margin-top:8px">
        <button id="btnWatchAd" class="btn">‚ñ∂ Reklama</button>
        <button id="btnClaim" class="btn" aria-disabled="true">Preuzmi</button>
      </div>
    </div>
    <div style="text-align:right; margin-top:8px"><button id="closeAch" class="btn">Zatvori</button></div>
  </div></div>

  <div id="collectionModal" class="overlay"><div class="backdrop"></div><div class="panel">
    <h3>Kolekcija</h3>
    <div style="display:flex; gap:8px; margin-bottom:8px">
      <button id="tabThemes" class="btn" aria-selected="true">Teme</button>
      <button id="tabSkins" class="btn" aria-selected="false">Skinovi</button>
    </div>
    <div id="panelThemes">
      <div id="themesGrid" style="display:grid; grid-template-columns:repeat(2,1fr); gap:10px"></div>
    </div>
    <div id="panelSkins" aria-hidden="true" style="display:none">
      <div id="skinsGrid" style="display:grid; grid-template-columns:repeat(2,1fr); gap:10px"></div>
    </div>
    <div style="text-align:right; margin-top:8px"><button id="closeCollection" class="btn">Zatvori</button></div>
  </div></div>

  <div id="gameOver" class="overlay"><div class="backdrop"></div><div class="panel">
    <h2>Kraj igre</h2>
    <div id="goStats" style="margin:6px 0 12px 0">Score: 0 ‚Ä¢ Best: 0</div>
    <div style="display:flex; gap:8px; justify-content:center">
      <button id="playAgain" class="btn">Igraj ponovo</button>
      <button id="goMenu" class="btn">Meni</button>
    </div>
  </div></div>

  <!-- UVEK nakon HTML-a, tvoj postojeƒái script.js -->
  <script src="script.js"></script>
</body>
</html>
