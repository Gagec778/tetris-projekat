/* ====== THEME VARS ====== */
:root {
  --font-family: 'Inter', sans-serif;
  --transition-speed-fast: 0.2s;
  --transition-speed-med: 0.5s;
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);

  --cell-size: 28px;
}

body.dark-theme {
  --bg-color: #0d1117;
  --primary-text: #e6edf3;
  --secondary-text: #7d8590;
  --accent-gradient: linear-gradient(45deg, #f72585, #7209b7);
  --card-bg: rgba(30, 36, 46, 0.85);
  --card-border: rgba(137, 147, 163, 0.2);
  --shadow: rgba(0, 0, 0, 0.4);
  --primary-btn-bg: #238636;
  --game-board-bg: rgba(0, 0, 0, 0.3);
  --grid-line-color: rgba(107, 114, 128, 0.4);
}

body.neon-theme {
  --bg-color: #000000;
  --primary-text: #00ffde;
  --secondary-text: #8d8d8d;
  --accent-gradient: linear-gradient(45deg, #00ffde, #ff00ff);
  --card-bg: rgba(15, 15, 15, 0.85);
  --card-border: rgba(0, 255, 222, 0.3);
  --shadow: rgba(0, 255, 222, 0.2);
  --primary-btn-bg: #ff00ff;
  --game-board-bg: rgba(255, 255, 255, 0.05);
  --grid-line-color: rgba(0, 255, 222, 0.3);
}

body.gold-theme {
  --bg-color: #1a160d;
  --primary-text: #f5e8c7;
  --secondary-text: #a89a7f;
  --accent-gradient: linear-gradient(45deg, #ffd700, #f0e68c, #daa520);
  --card-bg: rgba(40, 32, 20, 0.85);
  --card-border: rgba(255, 215, 0, 0.2);
  --shadow: rgba(0, 0, 0, 0.5);
  --primary-btn-bg: #b8860b;
  --game-board-bg: rgba(0, 0, 0, 0.2);
  --grid-line-color: rgba(255, 215, 0, 0.3);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html { height: -webkit-fill-available; }
body {
  font-family: var(--font-family);
  background: var(--bg-color);
  color: var(--primary-text);
  margin: 0;
  overflow: hidden;
  height: 100vh;
  height: -webkit-fill-available;
  width: 100vw;
  transition: background-color 0.5s, color 0.5s;
}

/* BG */
@keyframes aurora-move { 0%{transform:translate(-50%,-50%) rotate(0)} 100%{transform:translate(-50%,-50%) rotate(360deg)} }
.aurora-background{position:fixed;top:50%;left:50%;width:150vmax;height:150vmax;animation:aurora-move 40s infinite linear;z-index:-1}
.aurora-dot{position:absolute;border-radius:50%;filter:blur(100px);opacity:.6}
.aurora-dot:nth-child(1){width:600px;height:600px;top:0;left:10%;background:#f72585}
.aurora-dot:nth-child(2){width:500px;height:500px;top:20%;left:60%;background:#7209b7}
.aurora-dot:nth-child(3){width:400px;height:400px;top:70%;left:20%;background:#4361ee}

/* LAYOUT */
.screen{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;flex-direction:column;padding:1rem;opacity:0;visibility:hidden;pointer-events:none;transition:opacity var(--transition-speed-med) ease}
.screen.active{opacity:1;visibility:visible;pointer-events:auto}
h2{font-size:2rem;font-weight:900;text-align:center;margin:1rem 0 2rem}
button{transition:transform var(--transition-speed-fast) ease}
button:active{transform:scale(.97)}

.primary-btn{background:var(--primary-btn-bg);color:white;border:none;border-radius:.5rem;padding:1rem 2rem;font-size:1.1rem;font-weight:700;cursor:pointer;box-shadow:0 4px 15px -5px var(--shadow)}
.primary-btn.secondary{background:var(--card-bg);color:var(--primary-text)}
.icon-btn{background:transparent;border:none;padding:.5rem;cursor:pointer;border-radius:50%;display:flex;align-items:center;justify-content:center}
.icon-btn:hover{background:var(--card-border)}
.gem-icon{margin-left:.5rem;color:gold}

.main-menu-header{position:absolute;top:1rem;left:1rem;right:1rem;display:flex;justify-content:space-between;align-items:center;z-index:10}
.gem-balance{display:flex;align-items:center;background:var(--card-bg);border-radius:2rem;padding:.5rem 1rem;font-weight:700;font-size:1.2rem;border:1px solid var(--card-border)}

.menu-container{display:flex;flex-direction:column;align-items:center}
.menu-container h1{font-size:clamp(3rem,12vw,5.5rem);font-weight:900;line-height:1;letter-spacing:-.05em;background:var(--accent-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0 0 2rem}
.menu-item{border:1px solid var(--card-border);border-radius:1rem;padding:1px;margin:1rem auto;width:90%;max-width:420px;backdrop-filter:blur(20px);cursor:pointer}
.menu-item-content{background:var(--card-bg);border-radius:inherit;padding:2rem}
.menu-item:hover{transform:translateY(-5px) scale(1.02)}
.menu-item h2{margin:0;font-weight:700;font-size:1.4rem}

.shop-tabs{display:flex;gap:.5rem;border-bottom:2px solid var(--card-border);margin-bottom:1rem}
.shop-tab{padding:1rem;background:transparent;border:none;color:var(--secondary-text);font-weight:700;cursor:pointer;border-bottom:3px solid transparent}
.shop-tab.active{color:var(--primary-text);border-bottom-color:var(--primary-btn-bg)}
.shop-container{width:100%;max-width:900px;height:calc(100vh - 160px);overflow-y:auto;margin:0 auto}
.shop-grid{display:none;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem}
.shop-grid.active{display:grid}
.shop-item{background:var(--card-bg);border-radius:1rem;border:2px solid var(--card-border);padding:1rem;text-align:center}
.shop-item.active-item{border-color:gold;box-shadow:0 0 10px gold}
.shop-item-preview{height:120px;margin-bottom:1rem;display:flex;justify-content:center;align-items:center;border-radius:.5rem;padding:.5rem;border:2px dashed var(--card-border);gap:6px;flex-wrap:wrap}
.shop-item-price{font-weight:700;margin:.5rem 0}
.shop-item-btn{width:100%;padding:.75rem;border:none;border-radius:.5rem;cursor:pointer;background:var(--primary-btn-bg);color:white;font-weight:700}

.achievements-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;margin:0 auto;width:100%;max-width:900px}
.achievement-card{background:var(--card-bg);border:1px solid var(--card-border);border-radius:1rem;padding:1rem;position:relative}
.achievement-card .badge{position:absolute;top:.5rem;right:.5rem;background:#ffd54f;color:#000;padding:.2rem .5rem;border-radius:.5rem;font-weight:800;font-size:.75rem}
.achievement-actions{margin-top:.75rem;display:flex;gap:.5rem}

#game-screen{padding:.5rem;justify-content:center;align-items:center}
.game-area{display:none;width:100%;height:100%}
.game-area.active{display:flex}
#tetris-board{display:grid;grid-template-columns:repeat(10, var(--cell-size));grid-template-rows:repeat(20, var(--cell-size));background:var(--game-board-bg);border-radius:8px;gap:1px;padding:4px}
#puzzle-board{display:grid;grid-template-columns:repeat(10, var(--cell-size));grid-template-rows:repeat(10, var(--cell-size));background:var(--game-board-bg);border-radius:8px;gap:1px;padding:4px}
.tetris-cell,.puzzle-cell{width:var(--cell-size);height:var(--cell-size);box-shadow:inset 0 0 0 1px var(--grid-line-color);border-radius:6px;background:rgba(255,255,255,.02)}

/* BLOCK SKINS */
.game-block{border-radius:6px;position:relative;overflow:hidden}
.block-style-default .game-block{background:linear-gradient(160deg, rgba(255,255,255,0.2), transparent 60%), #2ea043;box-shadow:inset 0 2px 1px rgba(255,255,255,.35), inset 0 -2px 1px rgba(0,0,0,.25), 0 5px 10px rgba(0,0,0,.35)}
.block-style-neon .game-block{background:linear-gradient(160deg, rgba(255,255,255,.1), transparent 60%), #00d1ff;box-shadow:0 0 6px #fff, 0 0 12px #00d1ff;border:1px solid #00e7ff}
.block-style-wood .game-block{background-image:linear-gradient(135deg,#8c5a2e,#6b4522);box-shadow:inset 0 0 5px rgba(0,0,0,.5);border:1px solid #4a2d1e}
.block-style-retro .game-block{border:2px solid var(--primary-text);background:repeating-linear-gradient(45deg,transparent,transparent 2px,rgba(255,255,255,.08) 2px,rgba(255,255,255,.08) 4px);box-shadow:none;border-radius:0}

/* Ghost */
.tetris-cell.ghost .game-block,
.puzzle-cell.ghost .game-block{opacity:.35;filter:saturate(1.2)}

/* Puzzle pieces palette */
#puzzle-pieces-container{display:flex;justify-content:space-around;align-items:center;min-height:96px;padding:8px}
.puzzle-piece{cursor:grab;display:grid;grid-gap:1px}
.puzzle-piece-cell{width:22px;height:22px;border-radius:4px}
.puzzle-piece.dragging{position:fixed;z-index:1000;pointer-events:none;opacity:.85;transform:scale(1.1)}
.puzzle-piece.bad-move{animation:shake .25s}
@keyframes shake{10%,90%{transform:translateX(-1px)}20%,80%{transform:translateX(2px)}30%,50%,70%{transform:translateX(-4px)}40%,60%{transform:translateX(4px)}}

/* Modals, notifications */
.modal-overlay,.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);backdrop-filter:blur(10px);display:flex;justify-content:center;align-items:center;z-index:2000;opacity:0;visibility:hidden;transition:opacity .3s}
.modal-overlay.active,.overlay.active{opacity:1;visibility:visible}
.modal-content{background:var(--card-bg);border:1px solid var(--card-border);border-radius:1rem;padding:2rem;width:90%;max-width:480px;box-shadow:0 10px 50px var(--shadow);transform:scale(.96)}
.close-modal{position:absolute;top:1rem;right:1.5rem;font-size:2rem;color:var(--secondary-text);cursor:pointer}

#notification-area{position:fixed;bottom:1.2rem;left:50%;transform:translateX(-50%);z-index:3000;display:flex;flex-direction:column;align-items:center;gap:.5rem;pointer-events:none}
.notification{background:var(--card-bg);color:var(--primary-text);padding:1rem;border-radius:.5rem;box-shadow:0 6px 20px rgba(0,0,0,.35)}
.toast-success{border:1px solid #2ea043}
.toast-warn{border:1px solid #ffcc00}
